{% extends "base.html" %}
{% load static %}
{% load widget_tweaks %}
{% load crispy_forms_tags %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'checkout/css/checkout.css' %}">
{% endblock %}
{% block extra_js %}
<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
{% endblock %}

{% block content %}
<div class="overlay container"></div>
<div class="container header-container">
  <div class="row">
    <div class="col text-center mt-3">
      <h2 class="logo-font">Quotation</h2>
      <hr class="w-50 mb-1">
    </div>
  </div>
  <div class="row">
    <div class="col mt-3">
      <h4>Actual Weight: {{weight|floatformat:2}}kg</h4>
      <h4>Volume Weight: {{volume|floatformat:2}}kg</h4>
      <h4>Price: Â£{{total_price|floatformat:2}}</h4>

      {{form_data}}
    </div>
  </div>
  <div class="row">
    <div class="col-12">

      <form method="POST" class="form mb-2 p-3 bg-white" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="container">
          <div class="row ">
            <div class="col-12 col-md-6">
              <fieldset>
                <legend>Collection</legend>
                {{ quote_form.c_postcode | as_crispy_field }}

              </fieldset>
            </div>

            <div class="col-12 col-md-6">
              <fieldset>
                <legend>Delivery</legend>
                {{ quote_form.d_postcode | as_crispy_field }}

              </fieldset>
            </div>

          </div>
          <div class="row">
            <h4 class="w-100 px-3">Service</h4>
            <div class="col-md-6 col-12 p-3">
              <fieldset>
                <legend class="lead">Time</legend>
                {{ quote_form.service | as_crispy_field }}
              </fieldset>
            </div>
            <div class="col-md-6 col-12 p-3">
              <fieldset>
                <legend class="lead">Speciality</legend>
                {{ quote_form.spec_service | as_crispy_field }}

              </fieldset>
            </div>

          </div>
          <div class="row">
            <fieldset>
              <legend class="w-100">Dimensions & Weight</legend>
              <div class="col-12">
                <div class="row">
                  <div class="col-3">
                    {{ quote_form.weight | as_crispy_field }}
                  </div>
                  <div class="col-3">
                    {{ quote_form.height | as_crispy_field }}
                  </div>
                  <div class="col-3">
                    {{ quote_form.length | as_crispy_field }}
                  </div>
                  <div class="col-3">
                    {{ quote_form.width | as_crispy_field }}
                  </div>
                </div>
              </div>
            </fieldset>
          </div>
        </div>
        <div class="text-right">
          <button action="" class="btn-dark btn btn-md rounded-0" type="submit">Enter Details</button>
          <button class="btn-dark btn btn-md rounded-0" type="submit">Update Quote!</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div id="loading-overlay">
  <h1 class="text-light logo-font loading-spinner wrapper">
    <span class="circle circle-1"></span>
    <span class="circle circle-2"></span>
    <span class="circle circle-3"></span>
    <span class="circle circle-4"></span>
  </h1>
</div>
{% endblock %}

{% block postloadjs %}

<script>
  $("#contact-form").submit(function (e) {
    $('#loading-overlay').fadeToggle(100);
  })
  $("#id_c_county").prepend('<option value="" selected="selected">County</option>');
  $("#id_d_county").prepend('<option value="" selected="selected">County</option>');

  let cCountySelected = $('#id_c_county').val();
  if (!cCountySelected) {
    $('#id_c_county').css('color', '#aab7c4');
  };
  $('#id_c_county').change(function () {
    cCountySelected = $(this).val();
    if (!cCountySelected) {
      $(this).css('color', '#aab7c4');
    } else {
      $(this).css('color', '#000');
    }
  });
  let dCountySelected = $('#id_d_county').val();
  if (!dCountySelected) {
    $('#id_d_county').css('color', '#aab7c4');
  };
  $('#id_d_county').change(function () {
    dCountySelected = $(this).val();
    if (!dCountySelected) {
      $(this).css('color', '#aab7c4');
    } else {
      $(this).css('color', '#000');
    }
  }); 
</script>

<script>
  $(document).ready(function () {
    $("#div_id_service").children('div').addClass("d-flex flex-row service");
    $(".d-flex.flex-row.service").children().children('input').addClass("time m-3");
    $(".d-flex.flex-row.service").children('div').addClass("m-3");
    $('input.time').on('change', function () {
      $('input.time').not(this).prop('checked', false);
    });
    $("#div_id_spec_service").children('div').addClass("d-flex flex-row special");
    $(".d-flex.flex-row.special").children().children('input').addClass("special m-3");
    $(".d-flex.flex-row.special").children('div').addClass("m-3");
    $('input.special').on('change', function () {
      $('input.special').not(this).prop('checked', false);
    });
  });
</script>

{% endblock %}